SQL&gt; 
<br>
SQL&gt; SELECT
<br>
  2      D.DEPARTMENT_ID,
<br>
  3      UPPER(D.DEPARTMENT_NAME) AS &quot;NOM DU DEPARTMENT&quot;,
<br>
  4      EM.FIRST_NAME||' '||EM.LAST_NAME AS &quot;NOM DU MANAGER&quot;,
<br>
  5      COUNT(DISTINCT(E.EMPLOYEE_ID)) AS &quot;NOMBRE D'EMPLOYES&quot;,
<br>
  6      (
<br>
  7          SELECT
<br>
  8              COUNT(JH.EMPLOYEE_ID)
<br>
  9          FROM
<br>
 10              DEPARTMENTS D
<br>
 11              JOIN JOB_HISTORY JH ON (JH.DEPARTMENT_ID = D.DEPARTMENT_ID)
<br>
 12      ) &quot;NOMBRE D'EMPLOYES AYANT DEJA QUITTE LE DEPARTEMENT&quot;
<br>
 13  FROM
<br>
 14      DEPARTMENTS D
<br>
 15      JOIN EMPLOYEES E ON (E.DEPARTMENT_ID = D.DEPARTMENT_ID)
<br>
 16      JOIN EMPLOYEES EM ON (D.MANAGER_ID = EM.EMPLOYEE_ID)
<br>
 17  GROUP BY
<br>
 18      D.DEPARTMENT_ID, EM.FIRST_NAME||' '||EM.LAST_NAME, UPPER(D.DEPARTMENT_NAME)
<br>
 19  HAVING
<br>
 20      COUNT(DISTINCT(E.EMPLOYEE_ID)) &gt;= 5 ;
<br>
<p>
<table border='1' width='90%' align='center' summary='Script output'>
<tr>
<th scope="col">
DEPARTMENT_ID
</th>
<th scope="col">
NOM DU DEPARTMENT
</th>
<th scope="col">
NOM DU MANAGER
</th>
<th scope="col">
NOMBRE D'EMPLOYES
</th>
<th scope="col">
NOMBRE D'EMPLOYES AYANT DEJA QUITTE LE DEPARTEMENT
</th>
</tr>
<tr>
<td align="right">
        60
</td>
<td>
IT
</td>
<td>
Alexander Hunold
</td>
<td align="right">
         5
</td>
<td align="right">
        10
</td>
</tr>
<tr>
<td align="right">
       100
</td>
<td>
FINANCE
</td>
<td>
Nancy Greenberg
</td>
<td align="right">
         6
</td>
<td align="right">
        10
</td>
</tr>
<tr>
<td align="right">
        30
</td>
<td>
PURCHASING
</td>
<td>
Den Raphaely
</td>
<td align="right">
         6
</td>
<td align="right">
        10
</td>
</tr>
<tr>
<td align="right">
        50
</td>
<td>
SHIPPING
</td>
<td>
Adam Fripp
</td>
<td align="right">
        45
</td>
<td align="right">
        10
</td>
</tr>
<tr>
<td align="right">
        80
</td>
<td>
SALES
</td>
<td>
John Russell
</td>
<td align="right">
        34
</td>
<td align="right">
        10
</td>
</tr>
</table>
<p>

5 rows selected.<br>
<br>


SQL&gt; 
<br>
SQL&gt; 
<br>
SQL&gt; 
<br>
SQL&gt; (
<br>
  2          SELECT
<br>
  3              COUNT(DISTINCT(E.EMPLOYEE_ID))
<br>
  4          FROM
<br>
  5              DEPARTMENTS D
<br>
  6              JOIN EMPLOYEES E ON (E.DEPARTMENT_ID = D.DEPARTMENT_ID)
<br>
  7          WHERE
<br>
  8              E.SALARY*(1+NVL(E.COMMISSION_PCT, 0)) &gt; (SELECT AVG(SALARY*(1+NVL(COMMISSION_PCT, 0))) FROM EMPLOYEES)
<br>
  9      ) AS &quot;NOMBRE D'EMPLOYES AVEC SAL &gt; AVG(SAL)&quot;,
<br>
 10  
<br>
SQL&gt; 
<br>
SQL&gt;     COUNT(JH.EMPLOYEE_ID)||' '||(MIN(JH.END_DATE)) AS &quot;NOMBRE D'EMPLOYES AYANT DEJA QUITTE LE DEPARTEMENT&quot;
<br>
SP2-0734: unknown command beginning &quot;COUNT(JH.E...&quot; - rest of line ignored.
<br>
SQL&gt; SET MARKUP HTML OFF
<br>
SQL> SPOOL OFF
